<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>通灵战力计算器 - Sheet1</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        h1 { color: #333; }
        table { border-collapse: collapse; width: auto; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        .input-cell { background-color: #ffffcc; } /* 黄色输入区 */
        .calculated { background-color: #ffffcc; } /* 黄色计算结果 */
        .notes { margin-top: 20px; font-style: italic; }
    </style>
</head>
<body>
    <h1>通灵战力计算器 - Sheet1</h1>
    <table id="dataTable">
        <tr>
            <td>通灵</td>
            <td>生命</td>
            <td>攻击</td>
            <td>防御</td>
            <td>消耗声望（万）</td>
            <td>战力（代入收集加成）</td>
            <td>声望折算战力</td>
            <td>消耗铜币（仅作记录）</td>
            <td>请输入 1.全收集加成 2.忍者加成</td>
        </tr>
        <tr>
            <td>忍犬</td>
            <td>5867</td>
            <td>1681</td>
            <td>504</td>
            <td>1.5</td>
            <td class="calculated"></td>
            <td class="calculated"></td>
            <td>181w</td>
            <td></td>
        </tr>
        <tr>
            <td>蓝蛇</td>
            <td>5846</td>
            <td>1671</td>
            <td>502</td>
            <td>6</td>
            <td class="calculated"></td>
            <td class="calculated"></td>
            <td>685w</td>
            <td></td>
        </tr>
        <tr>
            <td>蛤蟆吉</td>
            <td>5846</td>
            <td>1671</td>
            <td>502</td>
            <td>11.3</td>
            <td class="calculated"></td>
            <td class="calculated"></td>
            <td>1368w</td>
            <td></td>
        </tr>
        <tr>
            <td>忍龟</td>
            <td>5846</td>
            <td>1671</td>
            <td>502</td>
            <td>25</td>
            <td class="calculated"></td>
            <td class="calculated"></td>
            <td>2738w</td>
            <td>全收集加成</td>
            <td class="input-cell"><input type="number" id="collectBonus" value="0.162" step="0.001"></td>
        </tr>
        <tr>
            <td>镰鼬</td>
            <td>5846</td>
            <td>1671</td>
            <td>502</td>
            <td>30</td>
            <td class="calculated"></td>
            <td class="calculated"></td>
            <td>3650w</td>
            <td>生命加成</td>
            <td class="input-cell"><input type="number" id="hpBonus" value="0.54" step="0.001"></td>
        </tr>
        <tr>
            <td>猿魔</td>
            <td>5846</td>
            <td>1671</td>
            <td>502</td>
            <td>34</td>
            <td class="calculated"></td>
            <td class="calculated"></td>
            <td>4500w</td>
            <td>攻击加成</td>
            <td class="input-cell"><input type="number" id="atkBonus" value="0.72" step="0.001"></td>
        </tr>
        <tr>
            <td>山椒鱼</td>
            <td>5846</td>
            <td>1671</td>
            <td>502</td>
            <td>40</td>
            <td class="calculated"></td>
            <td class="calculated"></td>
            <td>4563w</td>
            <td>防御加成</td>
            <td class="input-cell"><input type="number" id="defBonus" value="0.35" step="0.001"></td>
        </tr>
        <tr>
            <td>贝壳</td>
            <td>5846</td>
            <td>1671</td>
            <td>502</td>
            <td>38</td>
            <td class="calculated"></td>
            <td class="calculated"></td>
            <td>4562w</td>
            <td>注意事项：<br>五星S请选20.3%<br>4星S或者五星A请选16.2%<br><br>声望折算战力=通灵消耗总声望÷总战力</td>
        </tr>
        <tr>
            <td>蛤蟆仙人</td>
            <td>5846</td>
            <td>1671</td>
            <td>502</td>
            <td>38.5</td>
            <td class="calculated"></td>
            <td class="calculated"></td>
            <td>4800w</td>
            <td></td>
        </tr>
        <tr>
            <td>鲨鱼</td>
            <td>45029</td>
            <td>12867</td>
            <td>3860</td>
            <td>157.71</td>
            <td class="calculated"></td>
            <td class="calculated"></td>
            <td>2.1亿</td>
            <td></td>
        </tr>
        <tr>
            <td>蛤蟆健</td>
            <td>49987</td>
            <td>12885</td>
            <td>4330</td>
            <td>162.54</td>
            <td class="calculated"></td>
            <td class="calculated"></td>
            <td>2.2亿</td>
            <td></td>
        </tr>
        <tr>
            <td>乌鸦</td>
            <td>67586</td>
            <td>18664</td>
            <td>5837</td>
            <td>585.0438</td>
            <td class="calculated"></td>
            <td class="calculated"></td>
            <td>4.6亿</td>
            <td></td>
        </tr>
        <tr>
            <td>蛤蟆龙</td>
            <td>33764</td>
            <td>9304</td>
            <td>2901</td>
            <td>413</td>
            <td class="calculated"></td>
            <td class="calculated"></td>
            <td>8.6亿</td>
            <td></td>
        </tr>
        <tr>
            <td>蛤蟆广</td>
            <td>43068</td>
            <td>12301</td>
            <td>3725</td>
            <td>413.4</td>
            <td class="calculated"></td>
            <td class="calculated"></td>
            <td>8.6亿</td>
            <td></td>
        </tr>
        <tr>
            <td>梦貘</td>
            <td>43068</td>
            <td>12301</td>
            <td>3725</td>
            <td>413.4</td>
            <td class="calculated"></td>
            <td class="calculated"></td>
            <td>8.6亿</td>
            <td></td>
        </tr>
        <tr>
            <td>鹰</td>
            <td>43068</td>
            <td>12301</td>
            <td>3725</td>
            <td>413.4</td>
            <td class="calculated"></td>
            <td class="calculated"></td>
            <td>8.6亿</td>
            <td></td>
        </tr>
        <tr>
            <td>蜘蛛</td>
            <td>86055</td>
            <td>24579</td>
            <td>7443</td>
            <td>1354</td>
            <td class="calculated"></td>
            <td class="calculated"></td>
            <td>50.2亿</td>
            <td></td>
        </tr>
        <tr>
            <td>吾郎</td>
            <td>49600</td>
            <td>14382</td>
            <td>4000</td>
            <td>1354</td>
            <td class="calculated"></td>
            <td class="calculated"></td>
            <td>50.2亿</td>
            <td></td>
        </tr>
    </table>

    <script>
        const table = document.getElementById('dataTable');
        const inputs = {
            collect: document.getElementById('collectBonus'),
            hp: document.getElementById('hpBonus'),
            atk: document.getElementById('atkBonus'),
            def: document.getElementById('defBonus')
        };

        function calculate() {
            const collectBonus = parseFloat(inputs.collect.value) || 0;
            const hpBonus = parseFloat(inputs.hp.value) || 0;
            const atkBonus = parseFloat(inputs.atk.value) || 0;
            const defBonus = parseFloat(inputs.def.value) || 0;

            for (let i = 1; i < table.rows.length; i++) { // 从第2行开始 (index 1)
                const row = table.rows[i];
                const hp = parseFloat(row.cells[1].innerText) || 0;
                const atk = parseFloat(row.cells[2].innerText) || 0;
                const def = parseFloat(row.cells[3].innerText) || 0;
                const cost = parseFloat(row.cells[4].innerText) || 0;

                const power = 
                    hp * 1 * (1 + collectBonus * (1 + hpBonus)) +
                    atk * 3.5 * (1 + collectBonus * (1 + atkBonus)) +
                    def * 11.6 * (1 + collectBonus * (1 + defBonus));

                const ratio = cost > 0 ? power / cost : 0;

                row.cells[5].innerText = power.toFixed(5); // 保留小数
                row.cells[6].innerText = ratio.toFixed(9); // 保留更多小数以匹配原数据
            }
        }

        // 初始计算
        calculate();

        // 输入变化时重新计算
        Object.values(inputs).forEach(input => {
            input.addEventListener('input', calculate);
        });
    </script>
</body>
</html>
